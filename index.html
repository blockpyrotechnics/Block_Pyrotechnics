<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Block Pyrotechnics — Shop</title>
  <meta name="color-scheme" content="dark">
  <style>
    :root{
      --bg:#0e1116;
      --bg2:#0c0f14;
      --surface:#151a22;
      --surface-2:#1a2030;
      --text:#eaf0f6;
      --muted:#9fb0c3;
      --accent:#7df9ff; /* icy cyan */
      --accent-2:#22e1ff;
      --danger:#ff4d4d;
      --ok:#7dffa2;
      --ring: rgba(34, 225, 255, .35);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font: 15px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Inter, "Helvetica Neue", Arial, sans-serif;
      color:var(--text);
      background:
        radial-gradient(1200px 800px at 20% -10%, rgba(125,249,255,.06), transparent 60%),
        radial-gradient(1000px 700px at 100% 0%, rgba(34,225,255,.05), transparent 60%),
        linear-gradient(180deg, var(--bg), var(--bg2));
      letter-spacing:.2px;
    }
    .container{max-width:1200px;margin:0 auto;padding:20px}
    header.topbar{
      position:sticky; top:0; z-index:50;
      backdrop-filter: saturate(130%) blur(8px);
      background: linear-gradient(180deg, rgba(21,26,34,.75), rgba(21,26,34,.45));
      border-bottom:1px solid rgba(255,255,255,.06);
    }
    .topbar .wrap{
      display:grid; grid-template-columns: auto 1fr auto; gap:16px; align-items:center;
      padding:12px 20px; max-width:1200px; margin:0 auto;
    }
    .brand{display:flex; align-items:center; gap:14px; min-width:0}
    .brand img{width:42px;height:42px; border-radius:50%; display:block; filter: drop-shadow(0 0 12px rgba(125,249,255,.25));}
    .brand h1{font-size:16px; font-weight:600; margin:0; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; opacity:.92; letter-spacing:.4px}
    .search{
      display:flex; align-items:center; gap:10px; position:relative;
    }
    .search input{
      width:100%; background:var(--surface); border:1px solid rgba(255,255,255,.08);
      color:var(--text); padding:12px 14px 12px 42px; border-radius:14px;
      outline:none; transition:border .2s, box-shadow .2s, background .2s;
      caret-color: var(--accent);
    }
    .search svg{position:absolute; left:12px; top:50%; transform:translateY(-50%); opacity:.65}
    .search input:focus{
      border-color: var(--accent);
      box-shadow: 0 0 0 6px var(--ring);
      background: #121722;
    }
    .btn{
      position:relative; display:inline-flex; align-items:center; gap:10px;
      background: linear-gradient(180deg, #1f2636, #121722);
      border:1px solid rgba(255,255,255,.08); color:var(--text);
      padding:12px 16px; border-radius:14px; cursor:pointer;
      transition:transform .15s ease, box-shadow .2s ease, border .2s;
      user-select:none; overflow:hidden;
    }
    .btn:hover{transform: translateY(-1px); box-shadow: 0 10px 24px rgba(34,225,255,.09), inset 0 1px 0 rgba(255,255,255,.06);}
    .btn:active{transform: translateY(0)}
    .btn.glossy::after{
      content:""; position:absolute; inset:0; pointer-events:none;
      background: linear-gradient(140deg, rgba(255,255,255,.09), rgba(255,255,255,0) 35%);
      mix-blend-mode:screen; opacity:.85;
    }
    .btn.primary{
      border-color: rgba(125,249,255,.35);
      background: linear-gradient(180deg, #1f2a3a, #121722);
      box-shadow: inset 0 0 0 1px rgba(125,249,255,.15), 0 8px 24px rgba(125,249,255,.08);
    }
    main{padding:26px 20px}
    .grid{
      display:grid; gap:18px;
      grid-template-columns: repeat(auto-fit, minmax(220px,1fr));
    }
    .card{
      background: linear-gradient(180deg, #121722, #0f141d);
      border:1px solid rgba(255,255,255,.08);
      border-radius:16px; overflow:hidden; position:relative;
      transition: transform .15s ease, box-shadow .2s ease, border-color .25s;
    }
    .card::before{
      content:""; position:absolute; inset:-1px; border-radius:16px;
      background: radial-gradient(500px 300px at 50% -10%, rgba(125,249,255,.18), transparent 60%);
      filter: blur(12px); opacity:0; transition:opacity .2s;
    }
    .card:hover{transform: translateY(-2px); box-shadow: 0 16px 40px rgba(0,0,0,.4), 0 0 0 1px rgba(125,249,255,.12) inset;}
    .card:hover::before{opacity:1}
    .media{
      aspect-ratio: 4/3; background:#0d1118; display:flex; align-items:center; justify-content:center;
      border-bottom:1px solid rgba(255,255,255,.06);
    }
    .media img{max-width:100%; max-height:100%; object-fit:cover; display:block}
    .info{padding:14px}
    .title{font-size:15px; font-weight:600; margin:0 0 8px 0; letter-spacing:.2px}
    .price{display:flex; align-items:center; gap:10px; flex-wrap:wrap}
    .price .final{font-weight:700}
    .price .orig{opacity:.55; text-decoration: line-through}
    .badge{
      font-size:12px; padding:4px 8px; border-radius:999px;
      background:linear-gradient(180deg, rgba(125,249,255,.18), rgba(125,249,255,.08));
      border:1px solid rgba(125,249,255,.35);
      color:var(--text)
    }
    .actions{display:flex; gap:10px; margin-top:12px}
    .actions a, .actions button{
      text-decoration:none; color:var(--text)
    }
    /* Admin panel */
    .modal{position:fixed; inset:0; display:none; place-items:center; z-index:100; background: rgba(7,10,14,.55); backdrop-filter: blur(8px)}
    .modal.open{display:grid}
    .dialog{
      width:min(680px, 92vw);
      background: linear-gradient(180deg, #121722, #0f141d);
      border:1px solid rgba(255,255,255,.08); border-radius:16px; padding:18px;
      box-shadow: 0 30px 80px rgba(0,0,0,.5);
    }
    .dialog h2{margin:4px 0 14px 0; font-size:18px}
    .row{display:grid; grid-template-columns: 1fr 1fr; gap:12px}
    .row + .row{margin-top:12px}
    label{font-size:12px; opacity:.8; display:block; margin-bottom:6px}
    input[type="text"], input[type="number"], input[type="url"]{
      width:100%; background:var(--surface); border:1px solid rgba(255,255,255,.08);
      color:var(--text); padding:10px 12px; border-radius:12px; outline:none;
    }
    input:focus{border-color:var(--accent); box-shadow:0 0 0 5px var(--ring)}
    .dialog .actions{justify-content:flex-end}
    .toolbar{display:flex; align-items:center; justify-content:space-between; margin: 0 0 16px}
    .empty{
      text-align:center; opacity:.7; padding:40px 0; border:1px dashed rgba(255,255,255,.1); border-radius:16px;
    }
    footer{opacity:.6; font-size:12px; padding:20px; text-align:center}
    @media (max-width:760px){
      .topbar .wrap{grid-template-columns: auto 1fr auto}
      .brand h1{display:none}
      .row{grid-template-columns: 1fr}
    }
  </style>
</head>
<body>
  <header class="topbar">
    <div class="wrap">
      <div class="brand">
        <img src="assets/logo.png" alt="Block Pyrotechnics Logo" />
        <h1>Block Pyrotechnics</h1>
      </div>
      <div class="search">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M21 21l-4.2-4.2" stroke="white" opacity=".7" stroke-width="1.6" stroke-linecap="round"/>
          <circle cx="11" cy="11" r="6.5" stroke="white" opacity=".7" stroke-width="1.6"/>
        </svg>
        <input id="search" type="text" placeholder="Produkte suchen …">
      </div>
      <button id="adminBtn" class="btn glossy primary">Admin</button>
    </div>
  </header>

  <main class="container">
    <div class="toolbar">
      <div style="opacity:.7">Ein Shop mit <strong>Neo‑Noir</strong>‑Design &amp; Glow‑Akzenten.</div>
      <div id="adminState" class="badge" style="display:none">Admin aktiv</div>
    </div>

    <section id="grid" class="grid"></section>
    <div id="emptyState" class="empty" style="display:none">Noch keine Artikel. Öffne <strong>Admin</strong> &rarr; „Artikel hinzufügen“.</div>
  </main>

  <footer>© <span id="year"></span> Block Pyrotechnics — Prototype UI</footer>

  <!-- Admin Modal -->
  <div class="modal" id="adminModal" aria-hidden="true">
    <div class="dialog" role="dialog" aria-modal="true">
      <h2>Admin</h2>
      <div id="adminLogin">
        <label for="adminCode">Code eingeben</label>
        <input type="text" id="adminCode" placeholder="Admin-Code">
        <div class="actions" style="margin-top:12px">
          <button class="btn glossy" id="cancelLogin">Abbrechen</button>
          <button class="btn glossy primary" id="doLogin">Login</button>
        </div>
      </div>

      <div id="adminPanel" style="display:none">
        <div class="row">
          <div>
            <label>Artikelname</label>
            <input type="text" id="pName" placeholder="z. B. Cake 'Skyfall'">
          </div>
          <div>
            <label>Preis (EUR)</label>
            <input type="number" id="pPrice" placeholder="z. B. 39.99" step="0.01" min="0">
          </div>
        </div>
        <div class="row">
          <div>
            <label>Rabatt (%)</label>
            <input type="number" id="pDiscount" placeholder="z. B. 15" step="1" min="0" max="95">
          </div>
          <div>
            <label>Bild‑URL (PNG/JPG)</label>
            <input type="url" id="pImage" placeholder="https://…/bild.jpg">
          </div>
        </div>
        <div class="row">
          <div>
            <label>YouTube‑URL (optional)</label>
            <input type="url" id="pYouTube" placeholder="https://youtu.be/…">
          </div>
          <div>
            <label>Interne Notiz (optional)</label>
            <input type="text" id="pNote" placeholder="z. B. 25er Kiste">
          </div>
        </div>
        <div class="actions" style="margin-top:14px">
          <button class="btn glossy" id="exportBtn">Export JSON</button>
          <button class="btn glossy" id="clearBtn" style="border-color:rgba(255,77,77,.35); color:#ffdede">Alles löschen</button>
          <button class="btn glossy primary" id="addBtn">Artikel hinzufügen</button>
        </div>
      </div>
    </div>
  </div>

<script>
(() => {
  const € = sel => document.querySelector(sel);
  const €€ = sel => Array.from(document.querySelectorAll(sel));
  const fmtEUR = v => new Intl.NumberFormat('de-DE',{style:'currency',currency:'EUR'}).format(v);

  const ADMIN_CODE = "BLOCK-ADMIN-22"; // <- nach Wunsch ändern
  const LS_KEY = "bp_products_v1";

  const state = {
    admin:false,
    products: []
  };

  function load(){
    try{
      state.products = JSON.parse(localStorage.getItem(LS_KEY) || "[]");
    }catch{ state.products = []; }
  }
  function save(){
    localStorage.setItem(LS_KEY, JSON.stringify(state.products));
  }

  function priceWithDiscount(p){
    const price = Number(p.price||0);
    const d = Math.max(0, Math.min(95, Number(p.discount||0)));
    const final = +(price * (100 - d) / 100).toFixed(2);
    return {price, d, final};
  }

  function render(){
    const grid = €("#grid");
    grid.innerHTML = "";
    const q = €("#search").value.trim().toLowerCase();
    const list = state.products.filter(p => !q || (p.name||"").toLowerCase().includes(q));

    if(list.length === 0){
      €("#emptyState").style.display = "block";
      return;
    }
    €("#emptyState").style.display = "none";

    for(const p of list){
      const {price, d, final} = priceWithDiscount(p);
      const card = document.createElement("article");
      card.className = "card";

      const media = document.createElement("div");
      media.className = "media";
      const img = document.createElement("img");
      img.alt = p.name || "Artikelbild";
      img.loading = "lazy";
      img.src = p.image || "";
      media.appendChild(img);

      const info = document.createElement("div");
      info.className = "info";
      const h3 = document.createElement("h3");
      h3.className = "title";
      h3.textContent = p.name || "Ohne Namen";

      const priceDiv = document.createElement("div");
      priceDiv.className = "price";
      const finalEl = document.createElement("div");
      finalEl.className = "final";
      finalEl.textContent = fmtEUR(final);

      priceDiv.appendChild(finalEl);
      if(d>0){
        const orig = document.createElement("div");
        orig.className = "orig";
        orig.textContent = fmtEUR(price);
        const badge = document.createElement("span");
        badge.className = "badge";
        badge.textContent = "-" + d + "%";
        priceDiv.appendChild(orig);
        priceDiv.appendChild(badge);
      }

      const acts = document.createElement("div");
      acts.className = "actions";
      if(p.youtube){
        const a = document.createElement("a");
        a.href = p.youtube; a.target = "_blank"; a.rel="noopener";
        a.className = "btn glossy";
        a.innerHTML = "YouTube ansehen ▶";
        acts.appendChild(a);
      }
      const share = document.createElement("button");
      share.className = "btn glossy";
      share.textContent = "Link kopieren";
      share.onclick = async () => {
        const url = location.origin + location.pathname + "#p=" + encodeURIComponent(p.name||"");
        try{
          await navigator.clipboard.writeText(url);
          share.textContent = "Kopiert ✔";
          setTimeout(()=> share.textContent="Link kopieren", 1200);
        }catch{
          alert(url);
        }
      };
      acts.appendChild(share);

      info.appendChild(h3);
      info.appendChild(priceDiv);
      info.appendChild(acts);

      card.appendChild(media);
      card.appendChild(info);
      grid.appendChild(card);
    }
  }

  function ensureDemo(){
    if(state.products.length===0){
      state.products.push({
        name:"Demo Cake 'Neon Sky'",
        price:39.99,
        discount:20,
        image:"https://images.unsplash.com/photo-1530103862676-de8c9debad1d?w=1200",
        youtube:"https://youtu.be/dQw4w9WgXcQ"
      });
      save();
    }
  }

  // Admin modal logic
  const modal = €("#adminModal");
  const adminBtn = €("#adminBtn");
  const adminState = €("#adminState");
  adminBtn.addEventListener("click", () => {
    modal.classList.add("open");
    (€("#adminLogin")).style.display = state.admin ? "none" : "block";
    (€("#adminPanel")).style.display = state.admin ? "block" : "none";
    (€("#adminCode")).value = "";
    (€("#adminCode")).focus();
  });
  €("#cancelLogin").onclick = () => modal.classList.remove("open");
  €("#doLogin").onclick = () => {
    const code = (€("#adminCode")).value.trim();
    if(code === ADMIN_CODE){
      state.admin = true;
      adminState.style.display = "inline-block";
      (€("#adminLogin")).style.display = "none";
      (€("#adminPanel")).style.display = "block";
    }else{
      alert("Falscher Code");
    }
  };

  // Admin add
  €("#addBtn").onclick = () => {
    const name = (€("#pName")).value.trim();
    const price = parseFloat((€("#pPrice")).value);
    const discount = parseFloat((€("#pDiscount")).value || "0");
    const image = (€("#pImage")).value.trim();
    const youtube = (€("#pYouTube")).value.trim();
    if(!name || isNaN(price)){
      alert("Bitte Name und Preis angeben.");
      return;
    }
    state.products.push({name, price, discount, image, youtube});
    save(); render();
    // reset minimal fields
    (€("#pName")).value = "";
    (€("#pPrice")).value = "";
    (€("#pDiscount")).value = "";
    (€("#pImage")).value = "";
    (€("#pYouTube")).value = "";
  };

  // Export / Clear
  €("#exportBtn").onclick = () => {
    const data = JSON.stringify(state.products, null, 2);
    const blob = new Blob([data], {type:"application/json"});
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url; a.download = "block_pyrotechnics_products.json";
    document.body.appendChild(a); a.click(); a.remove();
    URL.revokeObjectURL(url);
  };
  €("#clearBtn").onclick = () => {
    if(confirm("Alle Artikel löschen?")){
      state.products = []; save(); render();
    }
  };

  // Search live
  €("#search").addEventListener("input", render);

  // Init
  (€("#year")).textContent = new Date().getFullYear();
  load();
  ensureDemo();
  render();

  // Deep-link: if #p=Name present, prefill search
  const m = location.hash.match(/#p=([^&]+)/);
  if(m){ €("#search").value = decodeURIComponent(m[1]); render(); }
})();
</script>
</body>
</html>
